# GWAS-results-analysis-01122021
4 Python files for GWAS results reading, filtering, annotation, and comparison
## Introduction of GWAS results analysis
The result files downloaded from GWA-Portal are large-size csv files which can't be opened in excel.Because we have hundreds of lipid phenotypes under control, freezing, and wounding stresses. A large number of csv files need to be further analyzed and it is unreasonable to do this manually.
Python is employed here for automatic data processing for a large set of csv files. A pipeline including csv reading, data filtering, lipid annotation, gene annotation, data compare, and result combination is developed using the most popular tool (Pandas) in Python. We divided different data processing steps into three Python file with very simple codes and detailed annotation.
## Instructions of three separate Python files
### First step: data reading, filtering
The raw csv file has 6 columns (chr, pos, score, maf, mac, GVE), first step is to filter data with a criteria of score>=2 and maf>=0.05. Then we combine the chromosome number and SNP position on each chromosome to generate a unique SNP position for each row. We also add another column of "exp_ID" to indidate the file name, type of treatment. For example, "set1_C1" means downloaded file-1 in first set of accessions under control condition. With this Python file, each raw csv file can be automatically processed to generated a smaller csv file with 8 columns and criteria of score>=2 and maf>=0.05.
### Second step: lipid annotation
We have a prepared csv file containing 4 columns (exp_ID, lipid name, lipid number, transformation) which indidates the lipid phenotypes and transformation methods in GWAS for each new generated csv file from previous step. In this Python program, merge function is used for data matching between GWAS result file and lipid code file according to exp_ID. Finally, 3 columns (lipid name, lipid number, transformation) are added to GWAS result file. Separate result files are combined into a single summary file.
### Thirdd step: further filtering, gene annotation
Based on the summarized file generated from last step, we furtherly filter the GWAS results with a more strict criteria of score>=6 and generated a new summarized file. We added two new columns of "start" and "end" to the new summary file, indicating a region of 10 kb upstream and downstream of each SNP. With this csv file and another file "Reference gene list.csv" containing all gene information of Arabidopsis downloaded from TAIR 10 database (http:// www.arabidopsis.org). We designed a for loop to look for nearby genes for each SNP and finally added a new column "Gene" to the GWAS summary file identifying all candidate genes.
### Final step: SNP comparison between different populations or between different stress conditions
We compared two result summary files for different populations under same stress condition or for same population but under different stress conditions using merge function.
Three columns (position, lipid name, transformation) are used for comparison. Finally, a new csv file for common SNPs between the two summary files is generated.